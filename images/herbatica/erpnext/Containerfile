# Custom ERPNext image with XML Importer app
# Based on official ERPNext image with additional custom apps

FROM frappe/erpnext:v15.84.0

# Switch to frappe user for app installation
USER frappe

# Set working directory to bench
WORKDIR /home/frappe/frappe-bench

# Install XML Importer app from your GitHub repository
RUN bench get-app xml_importer https://github.com/UhrinDavid/erpnext_xml_importer.git

RUN bench get-app https://github.com/frappe/erpnext-shipping.git --branch version-15

RUN bench get-app print_designer

# Build assets for all apps including the new custom app
# RUN bench build --app frappe --app erpnext --app xml_importer

# Switch back to root for any final configurations
USER root

# Set proper ownership
RUN chown -R frappe:frappe /home/frappe/frappe-bench

# Switch back to frappe user for runtime
USER frappe

# Keep the original entrypoint from base image
# No need to override CMD - inherits from base image